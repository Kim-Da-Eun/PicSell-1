<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="Search">
	
	<select id="search" resultType="kh.picsell.dto.WriterImageUpDTO">
		select * from imageup where REGEXP_LIKE (tag, #{tag})
	</select>

	<select id="align" resultType="kh.picsell.dto.WriterImageUpDTO" parameterType="java.util.Map">
		
		select * from (select imageup.*, row_number() over(order by img_seq ) as rown from imageup where REGEXP_LIKE (tag, #{tag})

		<if test="keyword2 != null">
			and REGEXP_LIKE (tag, #{keyword2})
		</if>
		<if test="file_extension != null">
			and file_extension = #{file_extension}
		</if>
		<if test="usage != null">
			and usage = #{usage}
		</if>
		<if test="orderBy != null">
			order by ${orderBy} desc
		</if>
		
		) where rown between #{start} and #{end}
	</select>
</mapper>